import{C as s,q as e,r as a,b as i,c as l,j as t,y as c,T as n,D as o}from"./index-vXRN0nb0.js";import{B as r}from"./button-BUgudlhj.js";import{P as d}from"./popup-7fAACdWw.js";import{S as m}from"./index-CrzNbpX5.js";import{B as p}from"./index-C8zUc8uH.js";import{a as u}from"./game-DqO2iwES.js";import"./dot-loading-BBOaOjEl.js";import"./attach-properties-to-component-CClyKAqJ.js";import"./common-DYHPXX_Z.js";function g(){var g;const h=e((s=>s.user.info)),j=e((s=>s.user.system)),[x,v]=a.useState([]),[N,k]=a.useState(!0),f=i(),y=l(),[b,w]=a.useState(!1),[S,T]=a.useState(!1);return a.useEffect((()=>{k(!0),s({url:"/task/list",method:"GET"}).then((s=>{if(k(!1),0==s.code){s.data.map((s=>{s.loading=!1}));const a=(e=s.data,Object.values(e.reduce(((s,e)=>{const a=e.type;return s[a]||(s[a]=[]),s[a].push(e),s}),{})));v(a)}var e}))}),[]),t.jsxs("div",{className:"task-page fadeIn",children:[t.jsxs("div",{className:"task-title",children:[t.jsxs("div",{className:"ky",children:[t.jsx("div",{className:"ky-label",children:"Available points"}),t.jsx("div",{className:"ky-score",children:null==(g=null==h?void 0:h.score)?void 0:g.toLocaleString()})]}),t.jsxs("div",{className:"right-score",children:[t.jsxs("div",{className:"right-score-item",children:[t.jsx("div",{className:"rs-label",children:"Guess the basic integral correctly once"}),t.jsxs("div",{className:"rs-code",children:[t.jsx("img",{src:"/assets/common/score.png",alt:"score"}),null==j?void 0:j.right_score]})]}),t.jsxs("div",{className:"right-score-item",children:[t.jsx("div",{className:"rs-label",children:"Hourly autonomous driving points"}),t.jsxs("div",{className:"rs-code",children:[t.jsx("img",{src:"/assets/common/score.png",alt:"score"}),null==j?void 0:j.auto_driver]})]})]})]}),t.jsx("div",{className:"update-title",children:"Upgrade"}),t.jsxs("div",{className:"gas-container",children:[t.jsxs("div",{className:"gas-item",children:[t.jsx("img",{src:"/assets/task/auto.png",className:"gas-icon"}),t.jsxs("div",{className:"gas-title",children:["Auto Driver",t.jsx("span",{children:"New"})]}),t.jsx("div",{className:"unlock-desc",children:"unLock"}),h.wallet?null:t.jsxs("div",{className:"gas-mask",onClick:()=>{w(!0)},children:[t.jsx("img",{src:"/assets/task/unlock.png",className:"lock-img"}),t.jsxs("div",{className:"unlock",children:["UnLock",t.jsx("img",{src:"/assets/task/right.png"})]})]})]}),t.jsxs("div",{className:"gas-item",onClick:()=>T(!0),children:[t.jsx("img",{src:"/assets/task/gas.png",className:"gas-icon"}),t.jsx("div",{className:"gas-title",children:"Refill the fuel tank"}),t.jsxs("div",{className:"unlock-desc",children:[t.jsx("img",{src:"/assets/common/score.png"}),t.jsx("span",{children:"Free"}),t.jsxs("span",{className:"lv",children:[t.jsxs("span",{className:"high",children:[null==h?void 0:h.free_gas," /"]})," ",null==j?void 0:j.free_gas]})]})]})]}),t.jsx("div",{className:"update-wrapper",children:t.jsx("div",{className:"update-item"})}),t.jsxs("div",{className:"task-list",children:[N?[...Array(5)].map(((s,e)=>t.jsx(m,{className:"skeleton",animated:!0},e))):null,x.map(((e,a)=>{return t.jsxs("div",{className:"item-wrapper",children:[t.jsxs("div",{className:"item-wrapper-title",children:[t.jsx("img",{src:`/assets/task/${i=e[0].type,i.includes("Game")?"game":i.includes("PortKey")?"portkey":i.includes("Aelf")?"aelf":"portkey"}.png`,className:"logo-pic"}),e[0].type]}),e.map(((e,i)=>{var l;return t.jsxs("div",{className:"task-list-item",children:[t.jsx("div",{className:"task-list-left",children:t.jsxs("div",{className:"middle",children:[t.jsx("div",{className:"middle-name",children:e.name}),t.jsxs("div",{className:"reward",children:[t.jsxs("span",{children:["+",null==(l=null==e?void 0:e.score)?void 0:l.toLocaleString()]})," ",t.jsx("img",{src:"/assets/common/score.png",alt:"tomato",className:"unit-img"})," Pts"]})]})}),t.jsx("div",{className:"task-list-right",children:t.jsx(r,{className:`task-list-right-btn ${e.status}`,onClick:()=>(async(e,a,i)=>{if("Done"!=e.status){const t=JSON.parse(JSON.stringify(x));t[a][i].loading=!0,v(t);const c=await(l=e,s({url:"/task/handle",method:"POST",data:l}));if(0==c.code){const s=JSON.parse(JSON.stringify(x));s[a][i].status=c.data.status,s[a][i].loading=!1,v(s)}else{n.show({content:c.msg,position:"top"});const s=JSON.parse(JSON.stringify(x));s[a][i].loading=!1,v(s)}null==e.status&&("1"==localStorage.getItem("h5PcRoot")?window.open(e.link):e.linkType.includes("telegram")?o().openLink(e.link):"outside"==e.linkType?window.open(e.link):"self"==e.linkType&&f(e.link))}var l})(e,a,i),loading:e.loading,children:e.status||"Start"})})]},i)}))]},a);var i}))]}),t.jsx(d,{visible:b,onMaskClick:()=>{w(!1)},bodyStyle:{borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},className:"popup-unlock",children:t.jsxs("div",{className:"pop-unlock-content maxWidth",children:[t.jsx("div",{className:"close",onClick:()=>w(!1),children:t.jsx("img",{src:"/assets/common/close.png"})}),t.jsx("img",{src:"/assets/task/auto.png",alt:"auto",className:"auto-img"}),t.jsx("div",{className:"new",children:"New"}),t.jsx("div",{className:"auto-title",children:"Auto Driver"}),t.jsx("div",{className:"auto-desc",children:"Bind your Telegram account with portKey and complete identity authentication to unlock autonomous driving. During your offline period, the game will automatically continue and earn points."}),t.jsxs("div",{className:"free",children:[t.jsx("img",{src:"/assets/common/score.png"}),t.jsx("span",{className:"free-title",children:"Free"}),t.jsx("span",{className:"lv",children:"Lv 10"})]}),t.jsx("div",{className:"learn-btn",onClick:()=>f("/wallet"),children:"Learn more"})]})}),t.jsx(d,{visible:S,onMaskClick:()=>{T(!1)},bodyStyle:{borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},className:"popup-unlock",children:t.jsxs("div",{className:"pop-unlock-content maxWidth",children:[t.jsx("div",{className:"close",onClick:()=>T(!1),children:t.jsx("img",{src:"/assets/common/close.png"})}),t.jsx("img",{src:"/assets/task/gas.png",alt:"auto",className:"auto-img"}),t.jsx("div",{className:"auto-title",children:"Refill the fuel tank"}),t.jsxs("div",{className:"auto-desc",children:["Enjoy ",null==j?void 0:j.free_gas," free fuel tank refills per day!"]}),t.jsxs("div",{className:"free",children:[t.jsx("img",{src:"/assets/common/score.png"}),t.jsx("span",{className:"free-title",children:"Free"}),t.jsxs("span",{className:"lv",children:[t.jsxs("span",{className:"high",children:[null==h?void 0:h.free_gas," /"]})," ",null==j?void 0:j.free_gas]})]}),t.jsx("div",{className:"learn-btn "+(h.free_gas?"":"btn-disable"),onClick:()=>(async()=>{if(h.free_gas){const s=await u();0==s.code?(y(c(s.data)),T(!1),n.show({content:"The fuel tank is already full!",position:"top"})):n.show({content:s.msg,position:"top"})}})(),children:"Fill up immediately"})]})}),t.jsx(p,{scrollName:"content"})]})}export{g as default};
