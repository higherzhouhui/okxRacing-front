import { useEffect, useState } from 'react';
import './index.scss'
import { throttle } from '@/utils/common';

function BackTop({ scrollName }: { scrollName?: string }) {
  const [isVisible, setIsVisible] = useState(false);

  // 判断是否显示回到顶部按钮
  const toggleVisibility = () => {
    const layoutElement = document.getElementsByClassName(scrollName || 'content')[0]
    if (layoutElement) {
      if (layoutElement.scrollTop > 300) {
        setIsVisible(true);
      } else {
        setIsVisible(false);
      }
    } else {
      setIsVisible(false)
    }
  };

  // 滚动事件监听器
  useEffect(() => {
    const layoutElement = document.getElementsByClassName(scrollName || 'content')[0]
    if (layoutElement) {
      layoutElement.addEventListener('scroll', throttle(toggleVisibility, 50))
    }
    return () => {
      layoutElement.removeEventListener('scroll', throttle(toggleVisibility, 50));
    };
  }, []);

  // 点击按钮回到顶部
  const scrollToTop = () => {
    const layoutElement = document.getElementsByClassName(scrollName || 'content')[0]

    layoutElement.scrollTo({
      top: 0,
      behavior: 'smooth',
    });
  };
  return <div className='back-top' onClick={() => scrollToTop()} style={{ display: isVisible ? 'block' : 'none' }}>
    <svg className='touch-btn' viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5006" width="32" height="32"><path d="M691.007793 346.714828c10.795335 50.948715 8.293977 104.727914-2.468446 156.894395a236.846545 236.846545 0 0 1 56.478033 195.797097 28.439273 28.439273 0 0 1-44.432019 18.431059c-21.096981-14.975236-49.154978-26.873143-81.244769-35.134207-9.709219 17.015818-19.714651 32.945519-29.73654 47.180221a28.299636 28.299636 0 0 1-23.203388 12.046014L457.542218 741.912951c-9.21553 0-17.888002-4.492571-23.219844-12.029558-10.021889-14.267615-20.027321-30.197317-29.73654-47.180221C372.545412 690.980693 344.470958 702.862143 323.390434 717.853836a28.392727 28.392727 0 0 1-44.432019-18.43106 236.869818 236.869818 0 0 1 56.395751-195.813553c-10.762422-52.166481-13.280237-105.929224-2.517814-156.910851C353.291537 249.984677 419.725633 177.231361 491.85361 105.103383c11.091548-11.091548 29.061832-11.091548 40.136924-0.016456 69.281037 69.281037 138.594986 144.980032 159.017259 241.627901z m9.956063 316.142042a189.300364 189.300364 0 0 0-27.926347-101.321459 637.207273 637.207273 0 0 1-31.234063 78.200353c21.491932 6.18757 41.453428 13.872664 59.16041 23.121106zM323.011939 662.840414c17.657613-9.231986 37.619109-16.884167 59.111041-23.10465a636.811636 636.811636 0 0 1-31.266976-78.16744 189.207273 189.207273 0 0 0-27.860521 101.255634z m65.331524-304.408698c-22.248922 105.451991 25.128775 237.448 84.190447 326.756358l78.842149 0.016456c59.045216-89.324814 106.406457-221.271454 84.09171-326.756358-15.436012-73.098899-65.7923-133.658095-123.570381-192.917243-57.745168 59.259148-108.101456 119.785432-123.553925 192.900787z m157.042502 40.959739a47.290182 47.290182 0 1 1-66.878417-66.878417 47.290182 47.290182 0 0 1 66.878417 66.878417zM470.26294 843.004022a47.313455 47.313455 0 1 1 83.449914 0.016456l-33.356926 62.418759a9.448727 9.448727 0 0 1-16.686692 0l-33.406296-62.435215z" fill="#ffffff" p-id="5007"></path><path d="M512 1024C229.236364 1024 0 794.763636 0 512S229.236364 0 512 0s512 229.236364 512 512-229.236364 512-512 512z m0-46.545455c257.070545 0 465.454545-208.384 465.454545-465.454545S769.070545 46.545455 512 46.545455 46.545455 254.929455 46.545455 512s208.384 465.454545 465.454545 465.454545z" fill="#ffffff" p-id="5008"></path></svg>
  </div>
}

export default BackTop