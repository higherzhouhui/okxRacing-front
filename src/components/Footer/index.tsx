import './index.scss';
import { useEffect, useState } from 'react';
import Link from '../Link';
import { useLocation } from 'react-router-dom';
import { initBackButton } from '@telegram-apps/sdk';
import EventBus from '@/utils/eventBus';
import { useConnectWallet } from '@aelf-web-login/wallet-adapter-react';
const TaskIcon = <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="18758" width="32" height="32"><path d="M530.46 269c4.64 0 9.05 2.01 12.09 5.52l109.54 126.3A16.01 16.01 0 0 1 656 411.3V893c0 8.82-7.18 16-16 16H178c-8.82 0-16-7.18-16-16V285c0-8.82 7.18-16 16-16h352.46m0-64H178c-44.18 0-80 35.82-80 80v608c0 44.18 35.82 80 80 80h462c44.18 0 80-35.82 80-80V411.3c0-19.26-6.95-37.87-19.56-52.42L590.9 232.58A80.014 80.014 0 0 0 530.46 205z" p-id="18759"></path><path d="M819.29 864h-45.92c-17.67 0-32-14.33-32-32s14.33-32 32-32h45.92c25.21 0 45.71-19.94 45.71-44.46V295.17c0-10.61-3.91-20.88-11.01-28.94L747.58 145.52c-8.7-9.87-21.35-15.52-34.7-15.52H370.49c-17.67 0-32-14.33-32-32s14.33-32 32-32h342.38c31.72 0 61.87 13.56 82.71 37.2L902 223.91c17.41 19.75 27 45.06 27 71.26v460.37C929 815.35 879.78 864 819.29 864z" p-id="18760"></path><path d="M702 468H552.09c-41.96 0-76.09-31.47-76.09-70.15V240.5h64v157.35c0 1.88 4.57 6.15 12.09 6.15H702v64zM898 326H748.09c-41.96 0-76.09-31.47-76.09-70.15V98.5h64v157.35c0 1.88 4.57 6.15 12.09 6.15H898v64zM535.13 784.5H262.88c-17.67 0-32 14.33-32 32s14.33 32 32 32h272.25c17.67 0 32-14.33 32-32s-14.33-32-32-32zM535.13 638.75H262.88c-17.67 0-32 14.33-32 32s14.33 32 32 32h272.25c17.67 0 32-14.33 32-32s-14.33-32-32-32zM535.13 493H262.88c-17.67 0-32 14.33-32 32s14.33 32 32 32h272.25c17.67 0 32-14.33 32-32s-14.33-32-32-32z" p-id="18761"></path></svg>
const LeaderBoard = <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11400" width="32" height="32"><path d="M916.262 941.33366666L107.72 941.33366666c-9.72 0-15.1 2.195-17.595 12.475-2.297 9.465 7.875 17.615 17.595 17.615l808.542 0c9.76 0 15.94-2.25 17.615-12.495C935.447 949.33366666 926.022 941.33366666 916.262 941.33366666zM714.117 890.56366666l197.026 0c9.76 0 17.615-7.875 17.6-17.615L928.743 600.21866666c0-9.74-7.84-17.61-17.615-17.61L714.112 582.60866666c-9.75 0-12.47 7.87-12.47 17.61l0 272.751c0 9.72 2.715 17.595 12.47 17.595L714.117 890.56466666zM731.732 612.69366666l166.92 0 0 247.786-166.92 0L731.732 612.69366666zM416.046 890.56366666l191.891 0c9.775 0 17.615-7.875 17.615-17.615L625.552 150.38666666c0-9.72-7.84-12.475-17.615-12.475L416.046 137.91166666c-9.72 0-17.595 2.755-17.595 12.475l0 722.562C398.451 882.68866666 406.326 890.56366666 416.046 890.56366666zM428.541 168.00166666l166.92 0 0 692.477-166.92 0L428.541 168.00166666zM107.72 890.56366666l197.03 0c9.72 0 17.613-7.875 17.578-17.615L322.328 438.49766666c0-9.702-7.893-17.595-17.598-17.595L107.72 420.90266666c-9.72 0-12.475 7.875-12.475 17.595l0 434.451C95.245 882.68866666 98 890.56366666 107.72 890.56366666L107.72 890.56366666zM125.335 450.99266666l166.92 0 0 409.466-166.92 0L125.335 450.99266666z" p-id="11401"></path></svg>
const WalletIcon = <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="21876" width="32" height="32"><path d="M787.584 164.138667a85.333333 85.333333 0 0 1 1.493333 15.936v13.653333A128.042667 128.042667 0 0 1 896 320v88.021333c36.821333 9.493333 64 42.88 64 82.645334v149.333333a85.376 85.376 0 0 1-64 82.645333V810.666667a128 128 0 0 1-128 128H192a128 128 0 0 1-128-128V320a128 128 0 0 1 127.744-128v-1.429333L687.829333 96.213333a85.333333 85.333333 0 0 1 99.776 67.904zM768 256H192a64 64 0 0 0-63.893333 60.245333L128 320v490.666667a64 64 0 0 0 60.245333 63.893333L192 874.666667h576a64 64 0 0 0 63.893333-60.245334L832 810.666667v-85.333334h-181.333333a160 160 0 0 1 0-320H832v-85.333333a64 64 0 0 0-60.245333-63.893333L768 256z m106.666667 213.333333H650.666667a96 96 0 0 0-4.522667 191.893334L650.666667 661.333333H874.666667a21.333333 21.333333 0 0 0 21.184-18.837333L896 640v-149.333333a21.333333 21.333333 0 0 0-18.837333-21.184L874.666667 469.333333z m-224 64a32 32 0 1 1 0 64 32 32 0 0 1 0-64z m51.584-374.549333l-2.474667 0.341333-172.949333 32.853334h198.229333v-12.906667l-0.341333-2.986667a21.333333 21.333333 0 0 0-22.464-17.28z" p-id="21877"></path></svg>
const HomeIcon = <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8358" width="32" height="32"><path d="M950.37 462.25l-40.68-36.77-96.4-87.15-113.35-102.48-92.71-83.8-26.4-23.88c-9.44-8.52-18.88-17.12-30.72-22.26-12.43-5.39-25.06-8.79-38.78-8.63-14 0.17-26.72 3.74-39.35 9.5-8.44 3.85-15.82 9.74-22.67 15.91q-8.79 7.92-17.56 15.87l-81.55 73.73L237.71 314Q185.84 360.87 134 407.76l-57.57 52-2.71 2.45c-11.68 10.56-11.54 31.87 0 42.45 12.48 11.46 30 11.27 42.45 0l32.44-29.33v357.61c0.05 22.8 7.86 43.13 22 60.81 16.81 21.1 44 32.72 70.71 32.94H754.7c9.39 0 18.78 0.08 28.17 0 30.75-0.28 57.61-15.12 75.74-39.53 11.54-15.53 16.83-35.24 16.86-54.42V475.44c10.54 9.6 21.08 19.19 31.75 28.64l0.69 0.62c11.65 10.53 31.11 12.36 42.46 0 10.54-11.48 12.44-31.2 0-42.45zM601 866.65H408.79V712.44c0-8.68-0.51-17.65 0.14-26.38a64.43 64.43 0 0 1 2.14-7.84 61.31 61.31 0 0 1 3.43-6c0.24-0.37 0.49-0.73 0.75-1.09 1-1.1 2.22-2.28 2.34-2.39 1-1 2.12-1.9 3.15-2.86a60.43 60.43 0 0 1 6.33-3.66 64.91 64.91 0 0 1 7.61-2.09c5.52-0.37 11.1-0.19 16.62-0.19h118.27c6.6 0 13.35-0.28 20 0.18a63.63 63.63 0 0 1 7.68 2.1 61.31 61.31 0 0 1 6 3.43c0.37 0.24 0.73 0.49 1.09 0.75 1.1 1 2.28 2.23 2.39 2.34 1 1 1.9 2.12 2.86 3.15a60.43 60.43 0 0 1 3.66 6.33 64.14 64.14 0 0 1 2.11 7.71c0.52 7.23 0.17 14.62 0.17 21.83v158.89zM413.66 673.07c-0.07-0.09 0.43-0.69 1.1-1.41a11.48 11.48 0 0 1-1.1 1.41z m188.71-8.25c0.09-0.07 0.69 0.43 1.41 1.1a11.48 11.48 0 0 1-1.41-1.1zM802.8 860l-0.33 0.23a62 62 0 0 1-6.89 4 66.72 66.72 0 0 1-8.2 2.24c-5.78 0.39-11.64 0.2-17.41 0.2h-94.45V692.21c0-18.32-4.54-37.37-15.37-52.43-17.64-24.5-44.13-39.55-74.69-39.86-47.12-0.49-94.27 0-141.4 0-17.15 0-33.51 3-48.8 11.22-26.91 14.48-43 42.11-46.11 71.93-0.63 6-0.39 12.16-0.39 18.21v165.37h-43.13c-21.34 0-42.69 0.14-64 0-1.62 0-3.23-0.07-4.84-0.18a67.88 67.88 0 0 1-8.3-2.27 62.59 62.59 0 0 1-6.32-3.59l-0.68-0.46c-1.12-1-2.25-2-3.31-3s-1.93-2.07-2.88-3.12c-0.08-0.11-0.16-0.21-0.23-0.32a62.93 62.93 0 0 1-4-6.89 67 67 0 0 1-2.32-8.57c-1.15-13.6-0.12-27.7-0.12-41.24V481c0-16.57 0.35-33.18 0-49.74v-0.73a28.21 28.21 0 0 0-1.28-8.31l40.17-36.32L358.07 286l93.53-84.56c13.78-12.45 27.43-25 41.33-37.36l0.07-0.08 0.31-0.28a81.1 81.1 0 0 1 7.23-4.23 65.24 65.24 0 0 1 7.52-2 65.9 65.9 0 0 1 7.95 0 66.41 66.41 0 0 1 7.47 2c2.44 1.25 4.77 2.64 7.12 4.11l0.71 0.63 1 0.86 6.11 5.52 25.52 23.08 89.38 80.8 110.36 99.77 53 47.92a29.47 29.47 0 0 0-1.21 8.38v357.19c0 15.38 0.12 30.77 0 46.15 0 1.54-0.07 3.08-0.17 4.61a66.32 66.32 0 0 1-2.28 8.31 60.78 60.78 0 0 1-3.58 6.33c-0.15 0.23-0.31 0.45-0.47 0.68-1 1.11-1.95 2.24-3 3.3s-2.12 1.94-3.17 2.87z" p-id="8359"></path></svg>
const FriendsIcon = <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20716" width="32" height="32"><path d="M958.72 582.528c-38.784-55.936-91.136-97.92-151.936-122.112 26.88-18.816 49.408-44.032 65.792-73.472 18.944-34.048 28.928-72.832 28.928-112.256 0-123.136-95.36-223.232-212.48-223.232-16.64 0-30.208 13.568-30.208 30.208 0 16.64 13.568 30.208 30.208 30.208 83.84 0 152.064 73.088 152.064 162.816 0 89.856-68.224 162.944-152.064 162.944-16.64 0-30.208 13.568-30.208 30.208l0 0.128c0 16.64 13.568 30.208 30.208 30.208 150.784 0 273.536 130.816 273.536 291.584 0 16.64 13.568 30.208 30.208 30.208 16.64 0 30.208-13.568 30.208-30.208C1022.848 714.624 1000.704 643.072 958.72 582.528L958.72 582.528zM646.784 531.2c-31.616-22.4-66.176-40.192-102.528-52.736 76.928-46.72 124.16-130.048 124.16-220.544C668.416 115.712 552.704 0 410.496 0 268.16 0 152.448 115.712 152.448 258.048c0 48.384 13.568 95.616 39.168 136.576 21.76 34.688 51.2 63.616 86.016 84.48-37.12 12.672-72.064 30.592-104.192 53.376-35.072 24.832-65.792 54.784-91.648 89.088C28.288 692.992 0 777.856 0 867.2c0 16.64 13.568 30.208 30.208 30.208 16.64 0 30.208-13.568 30.208-30.208 0-93.056 36.352-180.864 102.272-247.04 65.792-66.048 152.832-102.4 245.12-102.528 3.072 0.256 6.144 0 9.216-0.64l2.432-0.512c89.856 1.792 174.208 38.016 238.464 102.528 65.92 66.176 102.144 153.856 102.144 247.04 0 16.64 13.568 30.208 30.208 30.208 16.64 0 30.208-13.568 30.208-30.208 0-89.344-28.288-174.208-81.92-245.632C712.704 585.984 681.856 556.032 646.784 531.2L646.784 531.2zM410.496 60.416c108.928 0 197.632 88.704 197.632 197.632 0 108.928-88.704 197.632-197.632 197.632-108.928 0-197.632-88.704-197.632-197.632C212.864 148.992 301.568 60.416 410.496 60.416L410.496 60.416z" p-id="20717"></path></svg>

function FooterComp({ isH5PcRoot }: { isH5PcRoot?: boolean }) {
    const [backButton] = initBackButton()
    const { isConnected, isLocking } = useConnectWallet()
    const myLocation = useLocation()
    const eventBus = EventBus.getInstance()
    const [isShowFooter, setShowFooter] = useState(true)
    const [isIos, setIsIos] = useState(false)
    const menu = [
        {
            title: 'Racing',
            icon: HomeIcon,
            to: '/',
        },
        {
            title: 'LeaderBoard',
            icon: LeaderBoard,
            to: '/leaderboard',
        },
        {
            title: 'Task',
            icon: TaskIcon,
            to: '/task',
        },
        {
            title: 'Frens',
            icon: FriendsIcon,
            to: '/frens',
        },
        {
            title: 'Wallet',
            icon: WalletIcon,
            to: '/wallet',
        }
    ]
    useEffect(() => {
        let flag = true
        const hideBackPath = ['/']
        if (myLocation.pathname) {
            flag = menu.map((item) => {
                hideBackPath.push(item.to)
                return item.to
            }).includes(myLocation.pathname)
            setShowFooter(flag)
        } else {
            setShowFooter(true)
        }
        if (hideBackPath.includes(myLocation.pathname)) {
            backButton.hide()
            eventBus.emit('showBack', false)
        } else {
            backButton.show();
            eventBus.emit('showBack', true)
        }
        if (!isConnected && !isLocking) {
            // setShowFooter(false)
        }
    }, [myLocation.pathname, isConnected])

    useEffect(() => {
        const flag = /iPad|iPhone|iPod/.test(navigator.userAgent)
        setIsIos(flag)
    }, [])

    return <footer className="footer" style={{ display: isShowFooter ? 'block' : 'none', paddingBottom: isIos ? '1.5rem' : '1rem' }}>
        <div className='list'>
            {
                menu.map((item => {
                    return <Link to={item.to} key={item.title} className='menu-wrapper'>
                        <div className={`menu ${myLocation.pathname == item.to ? 'active' : ''}`} key={item.title}>
                            {item.icon}
                            <div className='title'>{item.title}</div>
                        </div>
                    </Link>
                }))
            }
        </div>
    </footer>
}

export default FooterComp;